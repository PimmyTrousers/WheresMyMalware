package main

import (
	"flag"
	"fmt"
	"os"

	"github.com/pimmytrousers/WheresMyMalware/malsrc"
	"github.com/pimmytrousers/WheresMyMalware/services/hybrid"
	"github.com/pimmytrousers/WheresMyMalware/services/malshare"
	"github.com/pimmytrousers/WheresMyMalware/services/virustotal"
)

var hash string

func init() {
	flag.StringVar(&hash, "h", "", "Hash to query the various services for")
}

func main() {
	flag.Parse()
	if hash == "" {
		flag.PrintDefaults()
		os.Exit(1)
	}

	allocators := map[string]malsrc.MalwareService{
		"HybridAnalysis": hybrid.Client{},
		"VirusTotal":     virustotal.Client{},
		"MalShare":       malshare.Client{},
	}

	for name, allocator := range allocators {
		fmt.Println(name, allocator)
	}

}
