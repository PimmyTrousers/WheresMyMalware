package malsrc

import (
	"encoding/hex"
	"errors"
)

// Hash is a enum to support different types of hashes
type Hash int

const (
	// MD5 is the enum to compare against for MD5 hashes
	MD5 Hash = iota
	// SHA1 is the enum to compare against for SHA1 hashes
	SHA1
	// SHA256 is the enum to compare against for SHA256 hashes
	SHA256
)

func GetHashType(hash string) (Hash, error) {
	digest, err := hex.DecodeString(hash)
	if err != nil {
		return 0, err
	}

	switch len(digest) {
	case 16:
		return MD5, nil
	case 20:
		return SHA1, nil
	case 32:
		return SHA256, nil
	}

	return 0, errors.New("invalid hash type")
}
